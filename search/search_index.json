{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Next generation matrix widget","text":""},{"location":"#model-summary","title":"Model summary","text":"<p>Consider a population composed of some number of groups. (The widget's default is 3 groups.) Let \\(R_{ij}\\) be the average number of infections in group \\(i\\) generated by an infected person in group \\(j\\). The matrix \\(\\mathbf{R}\\) is called the next-generation matrix (NGM) because, given the number of people infected in each group, the values \\(R_{ij}\\) can be used to compute the number of people infected in each group in the next generation of the epidemic.</p> <p>In the early stages of an epidemic, the values \\(R_{ij}\\) may remain relatively stable. (Later in an epidemic, these values will fall as people change their behavior and susceptibles are exhausted.) If we assume that enough generations have passed to allow the distribution of infections across groups to equilibrate, but few enough generations have passed so that we can assume the \\(R_{ij}\\) are constant, then the mathematical properties of the NGM allow us to compute the population wide basic reproduction number \\(R_0\\) and the distribution of infections across groups.</p> <p>The model accounts for vaccination by assuming that, if a proportion \\(v_i\\) of people in group \\(i\\) are vaccinated, then the average number of infections in group \\(i\\) produced by one group \\(j\\) infection is:</p> \\[ R^\\mathrm{vax}_{ij} = R_{ij} \\times (1 - v_i \\times \\mathrm{VE}) \\] <p>where VE is the vaccine efficacy. The reduced NGM yields the effective reproduction number \\(R_e\\).</p> <p>If we further assume that a fixed proportion of infections in each group have a severe outcome (but are otherwise identical for purposes of disease transmission), then we can also compute the population-wide proportion of infections that are severe.</p>"},{"location":"#mathematical-details","title":"Mathematical details","text":"<p>Let \\(x_i\\) be the proportion of infections in group \\(i\\) at equilibrium (i.e., so that \\(\\vec{x}\\) is the L1-normed dominant eigenvector) and \\(p_i\\) be the proportion of infections in group \\(i\\) that are severe. Then:</p> <ul> <li>The distribution of severe infections is the element-wise product \\(\\vec{x} \\odot \\vec{p}\\).</li> <li>The number of severe infections in each group per infection in the prior generation is \\(R_e \\times (\\vec{x} \\odot \\vec{p})\\).</li> <li>Starting with 1 infected person, the number of severe infections after \\(G\\) generations is approximately \\(R_e^G \\times (\\vec{x} \\odot \\vec{p})\\).</li> <li>The population-wide ratio of severe infections to all infections is the dot product \\(\\vec{x} \\cdot \\vec{p}\\).</li> </ul>"},{"location":"#further-reading","title":"Further reading","text":"<ul> <li>Linear algebra properties of NGMs</li> </ul>"},{"location":"linear_algebra/","title":"Linear algebra of next-generation matrices","text":""},{"location":"linear_algebra/#bluf","title":"BLUF","text":"<p>For many next-generation matrices \\(\\mathbf{R}\\), the population-wide reproduction number will approach the spectral radius of \\(\\mathbf{R}\\) (i.e., the absolute value of the eigenvector with the largest absolute value) and the distribution of infections will approach the corresponding eigenvector.</p>"},{"location":"linear_algebra/#motivation-reproduction-numbers-in-a-single-population","title":"Motivation: Reproduction numbers in a single population","text":"<p>The basic reproduction number \\(R_0\\) is the average number of infections caused by each infected person in an otherwise fully susceptible population. The effective reproduction number \\(R_\\mathrm{eff} \\leq R_0\\) is the average number of infections caused by each infected person, which is time-varying and depends on the number of remaining susceptibles.</p> <p>Make two assumptions:</p> <ol> <li>The number of infected people is much greater than 1, so that the actual number of secondary infections per infection approaches the theoretical mean \\(R_\\mathrm{eff}\\).</li> <li>Disease-free equilibrium: The number of infected people is small compared to the population so that \\(R_\\mathrm{eff}\\) approaches \\(R_0\\).</li> </ol> <p>Let \\(I(0)\\) be the number of people infected at some point in time. Under these two assumptions, the number of people in the next generation of infections will then be \\(I(1) = R_0 \\times I(0)\\). The number of infections grows exponentially with the number of generations \\(g\\):</p> \\[ I(g) = I(0) \\times R_0^g \\]"},{"location":"linear_algebra/#next-generation-matrices-reproduction-numbers-in-multiple-subpopulations","title":"Next-generation matrices: reproduction numbers in multiple subpopulations","text":"<p>In a structured population, with multiple subpopulations, the effective reproduction number is replaced by the next-generation matrix \\(\\mathbf{R}\\) with entries \\(R_{ij}\\), which are the number of infections in subpopulation \\(i\\) caused by an infected person in subpopulation \\(j\\). Note that the sum of entries in column \\(j\\), i.e. \\(\\sum_k R_{kj}\\), is the number of infections caused by an infected person in subpopulation \\(j\\).</p> <p>Make two assumptions similar to the above:</p> <ol> <li>\\(I_k(0) \\gg 1\\), where \\(I_k\\) is the number infected in subpopulation \\(k\\), for each subpopulation \\(k\\).</li> <li>The total number of infected \\(\\sum_k I_k(0)\\) is small compared to the size of every subpopulation.</li> </ol> <p>Let \\(\\mathbf{R}_0\\) be the next-generation matrix under the two assumptions above. Then the number of infections in each subpopulation in generation \\(g\\) follows \\(\\vec{I}(g) = \\mathbf{R}_0^g \\vec{I}(0)\\), that is, the matrix \\(\\mathbf{R}_0\\) is applied \\(g\\) times to the initial vector of infections \\(\\vec{I}(0)\\). Note that this is mathematically equivalent to a deterministic multi-type branching process model: each infection in each type \\(j\\) gives rise to exactly \\(R_{ij}\\) infections in subpopulation \\(i\\) in the next generation.</p>"},{"location":"linear_algebra/#eigen-analysis-for-growth-rates-under-a-stable-distribution-of-infections","title":"Eigen analysis for growth rates under a stable distribution of infections","text":"<p>A vector \\(\\vec{v}\\) is an eigenvector of matrix \\(\\mathbf{M}\\) with eigenvalue \\(\\lambda\\) if \\(\\mathbf{M} \\vec{v} = \\lambda \\vec{v}\\). In other words, the application of a matrix to one of its eigenvectors is to simply multiply that eigenvector by its corresponding eigenvalue.</p> <p>If a next-generation matrix \\(\\mathbf{R}\\) has a positive eigenvalue \\(\\lambda\\) with a corresponding non-negative eigenvector \\(\\vec{v}\\) (i.e., a vector with no negative entries), then we can interpret \\(\\vec{v}\\) as a stable distribution of infections across populations and \\(\\lambda\\) as the corresponding population-wide reproduction number, since:</p> \\[ \\mathbf{R}^g \\vec{v} = \\lambda^g \\vec{v} \\]"},{"location":"linear_algebra/#all-ngms-have-a-dominant-eigenvalue-and-eigenvector","title":"All NGMs have a dominant eigenvalue and eigenvector","text":"<p>NGMs are square matrices with non-negative entries. By an extension to the Perron-Frobenius theorem, these matrices have these properties:</p> <ol> <li>There is a dominant eigenvalue, which is a real, non-negative eigenvalue that is greater than or equal to the absolute value of any other eigenvalue (i.e., is equal to the spectral radius).</li> <li>The eigenvector (or one of the eigenvectors) corresponding to the dominant eigenvalue, called the dominant eigenvector, is non-negative (i.e., does not have a mix of positive and negative entries).</li> </ol> <p>NGMs can furthermore be irreducible, meaning that there is a way for an infection in any subpopulation to eventually cause an infection in every other subpopulation. (This is a sensible requirement for our analyses. If there were separate \"blocks\" of subpopulations that were epidemiologically independent, we could model them in separate NGMs.) All positive matrices (i.e., with no zeros) are irreducible.</p> <p>Irreducible NGMs have these additional properties:</p> <ol> <li>The dominant eigenvalue is positive.</li> <li>All other eigenvalues have absolute values smaller than the dominant eigenvalue.</li> <li>The dominant eigenvector has at least one positive entry.</li> <li>There are no other non-negative eigenvectors.</li> </ol>"},{"location":"linear_algebra/#the-dominant-eigenvalue-is-a-proxy-for-population-wide-r_0","title":"The dominant eigenvalue is a proxy for population-wide \\(R_0\\)","text":"<p>If the numbers of infections \\(\\vec{x}\\) across subpopulations were equal to the dominant eigenvector, then \\(R_0\\) is the dominant eigenvalue.</p> <p>This is also about as fast as the dynamics can get, regardless of the starting vector of infections \\(\\vec{x}\\). For all square, non-negative, irreducible NGMs, the Collatz-Wielandt formula also shows that the dominant eigenvalue is equal to:</p> \\[ \\max_{\\vec{x}} \\min_{i, x_i \\neq 0} \\frac{[\\mathbf{R}\\vec{x}]_i}{x_i} \\] <p>The term \\([\\mathbf{R}\\vec{x}]_i / x_i\\) is the growth in subpopulation \\(i\\) that will occur after one generation, starting from the vector of infection counts \\(\\vec{x}\\). The minimum is over the subpopulations (excluding those that had no infections to start with). The maximum is over all possible vectors of infection counts.</p>"},{"location":"linear_algebra/#for-diagonalizable-ngms-infections-tend-to-approach-the-dominant-eigenvector","title":"For diagonalizable NGMs, infections tend to approach the dominant eigenvector","text":"<p>An NGM may also be diagonalizable, in which case its eigenvectors form a basis. (All positive matrices are both irreducible and diagonalizable.) In this case, any distribution of infections \\(\\vec{x}\\) can be written as a linear combination of the eigenvectors \\(\\vec{v}_i\\):</p> \\[ \\vec{x} = \\sum_i \\alpha_i \\vec{v}_i \\] <p>In these cases, after \\(g\\) generations, that vector of infections will become:</p> \\[ \\mathbf{R}_0^g \\vec{x} = \\sum_i \\alpha_i \\mathbf{R}_0^g \\vec{v}_i = \\sum_i \\alpha_i \\lambda_i^g \\vec{v}_i \\] <p>where \\(\\lambda_i\\) are the corresponding eigenvalues.</p> <p>Without loss of generality, let \\(\\lambda_1\\) be the dominant eigenvalue. Then, after a sufficiently large number \\(g\\) of generations, the growth in the first eigenvector will outpace the others, that is, \\(\\lambda_1^g \\gg \\lambda_i^g\\) for any other \\(i \\neq 1\\). In that limit:</p> \\[ \\mathbf{R}_0^g \\vec{x} \\approx \\lambda_1^g \\vec{v}_1 \\] <p>so long as we actually begin with a vector \\(\\vec{x}\\) such that \\(\\alpha_1 &gt; 0\\). Thus, the population-wide reproduction number will approach \\(\\lambda_1\\) and the distribution of infections will approach \\(\\vec{v}_1\\).</p>"},{"location":"linear_algebra/#caveats-to-this-interpretation","title":"Caveats to this interpretation","text":""},{"location":"linear_algebra/#disease-free-equilibrium-but-also-approaching-the-stable-distribution","title":"Disease-free equilibrium but also approaching the stable distribution","text":"<p>We need the number of generations to be small enough that exponential growth has not depleted a meaningful number of susceptibles, but also large enough that the population-wide reproduction number approaches the dominant eigenvalue of \\(\\mathbf{R}\\).</p>"},{"location":"linear_algebra/#counterexample-matrices","title":"Counterexample matrices","text":"<p>An example of a non-negative, reducible, non-diagonalizable matrix is the \"L\" matrix:</p> \\[ \\begin{pmatrix} 1 &amp; 0 &amp; 0 \\\\ 1 &amp; 0 &amp; 0 \\\\ 1 &amp; 1 &amp; 1 \\end{pmatrix} \\] <p>These are curious dynamics:</p> <ul> <li>Each infection in subpopulation 1 produces 1 infection in each of the 3 subpopulations.</li> <li>Each infection in subpopulation 2 and 3 produces 1 infection in subpopulation 3.</li> </ul> <p>This matrix has two distinct eigenvalues: 1 and 0. Eigenvalue 1 has two eigenvectors that are multiples of one another: \\((0, 0, 1)\\) and \\((0, 0, -1)\\). Eigenvalue 0 has eigenvector \\((0, \\tfrac{1}{2}, -\\tfrac{1}{2})\\). As per the Perron-Frobenius theorem, there is a dominant eigenvalue 1 and dominant eigenvector \\((0, 0, 1)\\). However, because the matrix is reducible, the dominant eigenvalue is not larger than the absolute values of all other eigenvectors.</p> <p>Because the matrix is non-diagonalizable, we were not guaranteed that the eigenvectors would form a basis. In this particular case, any infection in any subpopulation would indeed lead to dynamics that approach the dominant eigenvalue and eigenvector.</p> <p>An example of a non-negative and irreducible matrix with multiple eigenvalues equal to the spectral radius is:</p> \\[ \\begin{pmatrix} 0 &amp; 1 \\\\ 1 &amp; 0 \\end{pmatrix} \\] <p>This NGM might very roughly model, for example, a sexually-transmitted disease in which each infected man infects one woman, and each infected woman infects one man. It has two eigenvalues: \\(1\\) and \\(-1\\), with corresponding eigenvectors \\((\\tfrac{1}{2}, \\tfrac{1}{2})\\) and \\((\\tfrac{1}{2}, -\\tfrac{1}{2})\\). Note that, as per the Perron-Frobenius theorem, there is a single non-negative eigenvalue that is greater than the absolute value of all other eigenvalues, and the corresponding eigenvector is non-negative.</p>"},{"location":"linear_algebra/#computational-notes","title":"Computational notes","text":"<p>There are standard algorithms for finding matrices' eigenvectors and eigenvalues (e.g., Python's <code>numpy.linalg.eig</code> and R's <code>eigen</code>), which may yield confusing results.</p>"},{"location":"linear_algebra/#eigenvectors-can-be-rescaled","title":"Eigenvectors can be rescaled","text":"<p>If \\(\\mathbf{M}\\) has eigenvector \\(\\vec{v}\\) with corresponding eigenvalue \\(\\lambda\\), then:</p> \\[ \\mathbf{M} \\vec{v} = \\lambda \\vec{v} \\] <p>For any scalar \\(\\alpha\\), it follows that:</p> \\[ \\mathbf{M} (\\alpha \\vec{v}) = \\lambda (\\alpha \\vec{v}) \\] <p>Thus, eigenvectors can be rescaled (including having their signs all changed). For example, an algorithm might return an eigenvector with all negative entries, but we would consider this a \"positive\" eigenvector, because we can swap the signs.</p> <p>The eigenvectors returned by an algorithm are likely L2-normed (i.e., the square root of the sum of squares of the entries sum to 1), to form an orthnormal basis. Because a stable distribution of infections should be a probability vector (i.e., entries sum to 1), you may need to rescale the eigenvector.</p>"},{"location":"linear_algebra/#real-valued-vs-real-typed","title":"Real-valued vs. real-typed","text":"<p>An algorithm might return a eigenvalues or eigenvectors that are real-valued but have a complex type. Be sure to check for the value, not the type, of the dominant eigenvalue and eigenvector. For example:</p> <pre><code>&gt;&gt;&gt; np.isreal(1+0j)\nTrue\n&gt;&gt;&gt; np.isrealobj(1+0j)\nFalse\n</code></pre>"},{"location":"linear_algebra/#determining-if-a-matrix-is-irreducible","title":"Determining if a matrix is irreducible","text":"<p>An \\(n \\times n\\) non-negative matrix \\(\\mathbf{R}\\) is irreducible if all entries of the matrix</p> \\[ (\\mathbb{I} + \\mathbf{R})^{n-1} \\] <p>are positive, where \\(\\mathbb{I}\\) is the identity matrix.</p>"},{"location":"linear_algebra/#determining-if-a-matrix-is-diagonalizable","title":"Determining if a matrix is diagonalizable","text":"<p>An \\(n \\times n\\) matrix is diagonalizable if it has \\(n\\) distinct eigenvalues. This is easy to check during an eigen analysis.</p>"},{"location":"linear_algebra/#further-reading","title":"Further reading","text":"<ul> <li>Matrix Analysis, which has a free pdf of the most relevant section</li> </ul>"}]}