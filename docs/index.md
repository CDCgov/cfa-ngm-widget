# Next generation matrix widget

## Model summary

Consider a population composed of some number of groups. (The widget's default is 3 groups.) Let $R_{ij}$ be the average number of infections in group $i$ generated by an infected person in group $j$. The matrix $\mathbf{R}$ is called the next-generation matrix (NGM) because, given the number of people infected in each group, the values $R_{ij}$ can be used to compute the number of people infected in each group in the next generation of the epidemic.

In the early stages of an epidemic, the values $R_{ij}$ may remain relatively stable. (Later in an epidemic, these values will fall as people change their behavior and susceptibles are exhausted.) If we assume that enough generations have passed to allow the distribution of infections across groups to equilibrate, but few enough generations have passed so that we can assume the $R_{ij}$ are constant, then the [mathematical properties](linear_algebra.md) of the NGM allow us to compute the population wide basic reproduction number $R_0$ and the distribution of infections across groups.

The model accounts for vaccination by assuming that, if a proportion $v_i$ of people in group $i$ are vaccinated, then the average number of infections in group $i$ produced by one group $j$ infection is:

```math
R^\mathrm{vax}_{ij} = R_{ij} \times (1 - v_i \times \mathrm{VE})
```

where VE is the vaccine efficacy. The reduced NGM yields the effective reproduction number $R_e$.

If we further assume that a fixed proportion of infections in each group have a severe outcome (but are otherwise identical for purposes of disease transmission), then we can also compute the population-wide proportion of infections that are severe.

## Mathematical details

Let $x_i$ be the proportion of infections in group $i$ at equilibrium (i.e., so that $\vec{x}$ is the L1-normed dominant eigenvector) and $p_i$ be the proportion of infections in group $i$ that are severe. Then:

- The distribution of severe infections is the element-wise product $\vec{x} \odot \vec{p}$.
- The number of severe infections in each group per infection in the prior generation is $R_e \times (\vec{x} \odot \vec{p})$.
- Starting with 1 infected person, the number of severe infections after $G$ generations is approximately $R_e^G \times (\vec{x} \odot \vec{p})$.
- The population-wide ratio of severe infections to all infections is the dot product $\vec{x} \cdot \vec{p}$.

## Further reading

- [Linear algebra properties](linear_algebra.md) of NGMs
